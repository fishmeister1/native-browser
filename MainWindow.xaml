<Window x:Class="NativeBrowser.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:wv2="clr-namespace:Microsoft.Web.WebView2.Wpf;assembly=Microsoft.Web.WebView2.Wpf"
        Title="Optica Surge" 
        Height="800" 
        Width="1200"
        MinHeight="400"
        MinWidth="600"
        WindowStyle="None" 
        AllowsTransparency="True"
        Background="Transparent"
        ResizeMode="CanResize"
        Icon="Assets/app.ico">
    
    <Border Background="{StaticResource WindowBackgroundBrush}" 
            BorderBrush="{StaticResource WindowBorderBrush}" 
            BorderThickness="1"
            CornerRadius="8">
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="40"/> <!-- Title Bar -->
                <RowDefinition Height="*"/> <!-- Content Area -->
            </Grid.RowDefinitions>
            
            <!-- Custom Title Bar -->
            <Grid Grid.Row="0" Background="{StaticResource TitleBarBackgroundBrush}">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="40"/> <!-- App Icon -->
                    <ColumnDefinition Width="*"/>  <!-- Title -->
                    <ColumnDefinition Width="Auto"/> <!-- Window Controls -->
                </Grid.ColumnDefinitions>
                
                <!-- App Icon -->
                <Image Grid.Column="0" 
                       Source="Assets/icon.png" 
                       Width="20" 
                       Height="20" 
                       Margin="10,0,0,0"
                       VerticalAlignment="Center"
                       HorizontalAlignment="Left"/>
                
                <!-- Tab Container -->
                <StackPanel Grid.Column="1" 
                           Orientation="Horizontal"
                           x:Name="TabContainer"
                           HorizontalAlignment="Left"
                           VerticalAlignment="Top"
                           Margin="10,0,0,0">
                    
                    <!-- Default tab -->
                    <Button Content="Google"
                           Style="{StaticResource TabItemStyle}"
                           Tag="Active"
                           x:Name="DefaultTab"
                           Click="Tab_Click"/>
                    
                    <!-- New tab button -->
                    <Button Style="{StaticResource NewTabButtonStyle}"
                           x:Name="NewTabButton"
                           ToolTip="New Tab"
                           Click="NewTab_Click"/>
                </StackPanel>
                
                <!-- Window Control Buttons -->
                <StackPanel Grid.Column="2" 
                           Orientation="Horizontal" 
                           HorizontalAlignment="Right">
                    
                    <!-- Minimize Button -->
                    <Button x:Name="MinimizeButton"
                            Style="{StaticResource WindowControlButtonStyle}"
                            Click="MinimizeButton_Click"
                            ToolTip="Minimize">
                        <Path Data="M0,6 L10,6" 
                              Stroke="{StaticResource ControlButtonForegroundBrush}" 
                              StrokeThickness="2"/>
                    </Button>
                    
                    <!-- Maximize/Restore Button -->
                    <Button x:Name="MaximizeButton"
                            Style="{StaticResource WindowControlButtonStyle}"
                            Click="MaximizeButton_Click"
                            ToolTip="Maximize">
                        <Path x:Name="MaximizeIcon"
                              Data="M0,2 L0,10 L8,10 L8,2 Z M0,2 L8,2"
                              Stroke="{StaticResource ControlButtonForegroundBrush}" 
                              StrokeThickness="1.5" 
                              Fill="Transparent"/>
                    </Button>
                    
                    <!-- Close Button -->
                    <Button x:Name="CloseButton"
                            Style="{StaticResource CloseButtonStyle}"
                            Click="CloseButton_Click"
                            ToolTip="Close">
                        <Path Data="M1,1 L9,9 M9,1 L1,9" 
                              Stroke="{StaticResource ControlButtonForegroundBrush}" 
                              StrokeThickness="1.5"/>
                    </Button>
                </StackPanel>
            </Grid>
            
            <!-- Main Content Area -->
            <Grid Grid.Row="1" Background="{StaticResource ContentBackgroundBrush}">
                <Grid.RowDefinitions>
                    <RowDefinition Height="60"/> <!-- Navigation Bar -->
                    <RowDefinition Height="*"/> <!-- Browser Content -->
                    <RowDefinition Height="25"/> <!-- Status Bar -->
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/> <!-- Main Content -->
                    <ColumnDefinition Width="Auto"/> <!-- Side Panel -->
                </Grid.ColumnDefinitions>
                
                <!-- Navigation Bar -->
                <Grid Grid.Row="0" Grid.ColumnSpan="2" Background="{StaticResource NavigationBarBackgroundBrush}">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    
                    <!-- Back Button -->
                    <Button Grid.Column="0" 
                            Style="{StaticResource NavigationButtonStyle}"
                            x:Name="BackButton"
                            ToolTip="Back"
                            Margin="10,15,5,15"
                            Click="BackButton_Click">
                        <Path Data="M6,2 L2,6 L6,10" 
                              Stroke="{StaticResource NavigationButtonForegroundBrush}" 
                              StrokeThickness="2"
                              Fill="Transparent"/>
                    </Button>
                    
                    <!-- Forward Button -->
                    <Button Grid.Column="1" 
                            Style="{StaticResource NavigationButtonStyle}"
                            x:Name="ForwardButton"
                            ToolTip="Forward"
                            Margin="5,15,5,15"
                            Click="ForwardButton_Click">
                        <Path Data="M2,2 L6,6 L2,10" 
                              Stroke="{StaticResource NavigationButtonForegroundBrush}" 
                              StrokeThickness="2"
                              Fill="Transparent"/>
                    </Button>
                    
                    <!-- Refresh Button -->
                    <Button Grid.Column="2" 
                            Style="{StaticResource NavigationButtonStyle}"
                            x:Name="RefreshButton"
                            ToolTip="Refresh"
                            Margin="5,15,10,15"
                            Click="RefreshButton_Click">
                        <Path Data="M8,2 A6,6 0 1,1 2,8" 
                              Stroke="{StaticResource NavigationButtonForegroundBrush}" 
                              StrokeThickness="2"
                              Fill="Transparent"/>
                    </Button>
                    
                    <!-- Address Bar -->
                    <TextBox Grid.Column="3"
                             x:Name="AddressBar"
                             Style="{StaticResource AddressBarStyle}"
                             Text="https://opticaai.org/"
                             Margin="10,13,10,13"
                             KeyDown="AddressBar_KeyDown"/>
                    
                    <!-- Menu Button -->
                    <Button Grid.Column="4"
                            Style="{StaticResource NavigationButtonStyle}"
                            x:Name="MenuButton"
                            ToolTip="Menu"
                            Margin="10,15,10,15"
                            Click="MenuButton_Click">
                        <Grid>
                            <!-- Hamburger Lines -->
                            <StackPanel x:Name="HamburgerIcon">
                                <Rectangle Height="2" Width="12" Fill="{StaticResource NavigationButtonForegroundBrush}" Margin="0,1"/>
                                <Rectangle Height="2" Width="12" Fill="{StaticResource NavigationButtonForegroundBrush}" Margin="0,1"/>
                                <Rectangle Height="2" Width="12" Fill="{StaticResource NavigationButtonForegroundBrush}" Margin="0,1"/>
                            </StackPanel>
                            <!-- Chevron Up -->
                            <Path x:Name="ChevronIcon" 
                                  Data="M2,8 L6,4 L10,8" 
                                  Stroke="{StaticResource NavigationButtonForegroundBrush}" 
                                  StrokeThickness="2"
                                  Fill="Transparent"
                                  Visibility="Collapsed"/>
                        </Grid>
                    </Button>
                </Grid>
                
                <!-- Browser Content -->
                <Border Grid.Row="1" Grid.Column="0"
                        x:Name="WebViewContainer"
                        Background="{StaticResource BrowserContentBackgroundBrush}"
                        Margin="2">
                    <wv2:WebView2 x:Name="WebView"
                                 Source="https://opticaai.org/"
                                 NavigationCompleted="WebView_NavigationCompleted"
                                 NavigationStarting="WebView_NavigationStarting"/>
                </Border>
                
                <!-- Side Panel -->
                <Border Grid.Row="1" Grid.Column="1"
                        x:Name="SidePanel"
                        Background="{StaticResource NavigationBarBackgroundBrush}"
                        Width="0"
                        BorderBrush="{StaticResource TabBorderBrush}"
                        BorderThickness="1,0,0,0">
                    <Grid x:Name="SidePanelContent">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="*"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>
                        
                        <!-- AI Chat Area -->
                        <ScrollViewer Grid.Row="0" 
                                     VerticalScrollBarVisibility="Auto"
                                     HorizontalScrollBarVisibility="Disabled"
                                     Margin="12,12,12,8"
                                     x:Name="ChatScrollViewer">
                            <StackPanel x:Name="ChatMessagesPanel" 
                                       Orientation="Vertical">
                                <!-- AI messages will be added here dynamically -->
                            </StackPanel>
                        </ScrollViewer>
                        
                        <!-- Floating Input Field -->
                        <Border Grid.Row="1" 
                                x:Name="MessageInputContainer"
                                Background="#2A2A2A"
                                CornerRadius="8"
                                Margin="12,8,12,12"
                                BorderBrush="#3E3E3E"
                                BorderThickness="1"
                                MinHeight="50"
                                VerticalAlignment="Bottom">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                
                                <!-- Text Input -->
                                <TextBox Grid.Column="0"
                                         x:Name="MessageInput"
                                         Background="Transparent"
                                         Foreground="#CCCCCC"
                                         BorderThickness="0"
                                         Padding="12,10,8,10"
                                         FontSize="13"
                                         FontFamily="Segoe UI"
                                         VerticalAlignment="Top"
                                         MinHeight="34"
                                         AcceptsReturn="True"
                                         TextWrapping="Wrap"
                                         VerticalScrollBarVisibility="Hidden"
                                         Text="Message Optica..."
                                         GotFocus="MessageInput_GotFocus"
                                         LostFocus="MessageInput_LostFocus"
                                         KeyDown="MessageInput_KeyDown"
                                         TextChanged="MessageInput_TextChanged"/>
                                
                                <!-- Action Buttons -->
                                <StackPanel Grid.Column="1" 
                                           Orientation="Horizontal"
                                           Margin="0,0,8,0">
                                    
                                    <!-- Attachment/Image Button -->
                                    <Button x:Name="AttachmentButton"
                                            Background="Transparent"
                                            BorderThickness="0"
                                            Width="32" Height="32"
                                            Cursor="Hand"
                                            ToolTip="Attach Image"
                                            Click="AttachmentButton_Click">
                                        <Rectangle Width="16" Height="14"
                                                  Fill="#CCCCCC">
                                            <Rectangle.OpacityMask>
                                                <VisualBrush>
                                                    <VisualBrush.Visual>
                                                        <Canvas Width="16" Height="14">
                                                            <Path Data="M14,2 L14,12 L2,12 L2,2 Z M4,4 L4,6 L6,6 L6,4 Z M2,8 L4,6 L6,8 L10,4 L14,8 L14,10 L2,10 Z" Fill="Black"/>
                                                        </Canvas>
                                                    </VisualBrush.Visual>
                                                </VisualBrush>
                                            </Rectangle.OpacityMask>
                                        </Rectangle>
                                    </Button>
                                    
                                    <!-- Microphone Button -->
                                    <Button x:Name="MicrophoneButton"
                                            Background="Transparent"
                                            BorderThickness="0"
                                            Width="32" Height="32"
                                            Cursor="Hand"
                                            ToolTip="Voice Message"
                                            Click="MicrophoneButton_Click">
                                        <Path Data="M8,2 C9.1,2 10,2.9 10,4 L10,8 C10,9.1 9.1,10 8,10 C6.9,10 6,9.1 6,8 L6,4 C6,2.9 6.9,2 8,2 Z M12,8 C12,10.7 9.8,12.9 7.1,13 L7.1,15 L11,15 L11,16 L5,16 L5,15 L8.9,15 L8.9,13 C6.2,12.9 4,10.7 4,8 L4,7 L5,7 L5,8 C5,10.2 6.8,12 9,12 C11.2,12 13,10.2 13,8 L13,7 L12,7 L12,8 Z"
                                              Fill="#CCCCCC"
                                              Stretch="Uniform"
                                              Width="14" Height="14"/>
                                    </Button>
                                    
                                    <!-- Send Button -->
                                    <Button x:Name="SendButton"
                                            Background="Transparent"
                                            BorderThickness="0"
                                            Width="32" Height="32"
                                            Cursor="Hand"
                                            ToolTip="Send Message"
                                            Click="SendButton_Click">
                                        <Path Data="M2,21 L23,12 L2,3 L2,10 L17,12 L2,14 Z"
                                              Fill="#CCCCCC"
                                              Stretch="Uniform"
                                              Width="16" Height="16"/>
                                    </Button>
                                </StackPanel>
                            </Grid>
                        </Border>
                    </Grid>
                </Border>
                
                <!-- Status Bar -->
                <Grid Grid.Row="2" Grid.ColumnSpan="2" Background="{StaticResource StatusBarBackgroundBrush}">
                    <TextBlock Text="Ready"
                              Foreground="{StaticResource StatusBarForegroundBrush}"
                              FontSize="11"
                              VerticalAlignment="Center"
                              Margin="10,0"
                              x:Name="StatusText"/>
                </Grid>
            </Grid>
        </Grid>
    </Border>
</Window>